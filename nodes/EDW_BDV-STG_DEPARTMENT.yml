fileVersion: 1
id: d2ed72a8-a0c4-44e2-a877-b69f500814e6
name: STG_DEPARTMENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: EDW_BDV
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e8e6ba0-f109-44ce-aa03-07e7db10e98e
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: VARIANT
        description: ""
        name: SRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ec484f52-a1d3-4bd0-92ce-93997cf89616
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_dept_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(DEPARTMENT.SRC, 'dept_id'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a0a9cad0-9b23-4ca6-9b6f-3308d48ab3b5
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_dept_name
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(DEPARTMENT.SRC, 'dept_name'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a25e664d-576e-4540-8163-f343078aef44
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_emp_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee.value, 'emp_id'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 947da85a-8b75-46fb-bd04-5a5608bf370c
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_emp_fname
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee.value, 'emp_fname'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d41cc7f3-73cc-4894-bed2-151b55a9cb9f
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_emp_lname
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee.value, 'emp_lname'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1edceb16-10f4-41a0-8a5b-875472c9a8e7
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_emp_title
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee.value, 'emp_title'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2c897a78-66b2-47d6-addc-e44d2559ac44
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_emp_ssn
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee.value, 'emp_ssn'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 07253b33-cf81-404d-b0b0-61203bda45f9
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_street_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'street_1'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9a98f6fe-18af-455d-9188-859f5a68dc8e
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_street_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'street_2'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ebb8ee8e-8a84-49ef-a6c9-617cb3ae5657
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_city
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'city'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4b904792-4af3-4a51-8c47-a0f4026be273
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_state
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'state'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7c820203-53c9-487c-bda4-6df8278e9e3c
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_zipcode
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'zipcode'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3495aa6c-d111-4f02-86c6-cdd708684c98
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_start_date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'start_date'), '$')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4c5b3f88-7421-4b93-b4e9-c9e7adef5025
          stepCounter: d2ed72a8-a0c4-44e2-a877-b69f500814e6
        config: {}
        dataType: STRING
        description: ""
        name: dept_employee_address_end_date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b201af-b485-4f26-b5aa-fbe588a64fd2
                stepCounter: 0dbda38c-0528-46d5-ab45-d19d9d455364
            transform: get(xmlget(dept_employee_address.value, 'end_date'), '$')
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: XML
            nodeName: DEPARTMENT
        join:
          joinCondition: |-
            FROM {{ ref('XML', 'DEPARTMENT') }} "DEPARTMENT", 
            LATERAL FLATTEN(input => get(DEPARTMENT.SRC, '$')) dept_employee, 
            LATERAL FLATTEN(input => get(dept_employee.value, '$')) dept_employee_address
            where get(dept_employee.value, '@') = 'employee'
        name: STG_DEPARTMENT
        noLinkRefs: []
  name: STG_DEPARTMENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
